<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì˜¤ëŠ˜ì˜ ê¸°ë¶„ì€</title>
    <style>
        h1 {
            background-image: linear-gradient(90deg, red, orange, yellow, green, blue, navy, purple);
            -webkit-background-clip: text;
            color: transparent;
            text-align: center;
            width: 280px;
            font-weight: bold;
            font-size: 40px;
            margin: auto;
            margin-bottom: 20px;
            
        }
        .button-container {
            display: flex;
            justify-content: center;
        }

        .button {
            background: none;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            margin: 5px;
            cursor: pointer;
            font-size: 100px;
            position: relative;
        }

        .crown {
            position: absolute;
            top: -20px;
            left: 40%;
            font-size: 24px;
            display: none; /* ì´ˆê¸°ì—ëŠ” ëª¨ë“  ì™•ê´€ ìˆ¨ê¹€ */
        }

        .button-text {
            font-size: 24px;
            margin: 0 10px;
        }

        .canvas-container {
            display: flex;
            justify-content: center;
            flex-direction: column;
            align-items: center;
            margin: 30px;
        }

        .canvas-container canvas {
            width: 600px;
        }

        #chart {
            border: 1px solid black;
        }

        .legend-container {
            display: flex;
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin-right: 20px;
        }

        #font-size {
            font-size: 60px;
        }

        #chartPercentage1, #chartPercentage2, #chartPercentage3, #chartPercentage4, #chartPercentage5 {
            font-size: 30px;
        }

        #chartPercentage1, #count1 { 
            color: orange;
        }

        #chartPercentage2, #count2 {
            color: rgb(0, 0, 215);
        }

        #chartPercentage3, #count3 {
            color: green;
        }

        #chartPercentage4, #count4 {
            color: red;
        }

        #chartPercentage5, #count5 {
            color: purple;
        }

        .legend-item .color-box {
            width: 20px;
            height: 20px;
            margin-right: 5px;
        }

        .crown {
            font-size: 40px;
        }
    </style>
</head>
<body>
    <h1>ì˜¤ëŠ˜ì˜ ê¸°ë¶„ì€</h1>
  <div class="button-container">
    <button class="button" id="button1"><img src="img/ê¸°ì¨.png"><span class="crown" id="crown1">ğŸ‘‘</span></button>
    <button class="button" id="button2"><img src="img/ìŠ¬í””.png"><span class="crown" id="crown2">ğŸ‘‘</span></button>
    <button class="button" id="button3"><img src="img/ê¹Œì¹ .png"><span class="crown" id="crown3">ğŸ‘‘</span></button>
    <button class="button" id="button4"><img src="img/ë²„ëŸ­.png"><span class="crown" id="crown4">ğŸ‘‘</span></button>
    <button class="button" id="button5"><img src="img/ì†Œì‹¬.png"><span class="crown" id="crown5">ğŸ‘‘</span></button>
  </div>
  <div class="button-container">
    <p class="button-text">ê¸°ì¨ ëˆŒë¦° íšŸìˆ˜: <span id="count1">0</span></p>
    <p class="button-text">ìŠ¬í”” ëˆŒë¦° íšŸìˆ˜: <span id="count2">0</span></p>
    <p class="button-text">ê¹Œì¹  ëˆŒë¦° íšŸìˆ˜: <span id="count3">0</span></p>
    <p class="button-text">ë²„ëŸ­ ëˆŒë¦° íšŸìˆ˜: <span id="count4">0</span></p>
    <p class="button-text">ì†Œì‹¬ ëˆŒë¦° íšŸìˆ˜: <span id="count5">0</span></p>
  </div>

  <div class="canvas-container">
    <canvas id="chart" width="480" height="200"></canvas>
    <div class="legend-container">
        <div class="legend-item">
            <div class="color-box" style="background-color: orange;"></div>
            <span id="font-size">ğŸ˜„</span>
            <span id="chartPercentage1">0%</span>
        </div>
        <div class="legend-item">
            <div class="color-box" style="background-color: blue;"></div>
            <span id="font-size">ğŸ˜¢</span>
            <span id="chartPercentage2">0%</span>
        </div>
        <div class="legend-item">
            <div class="color-box" style="background-color: green;"></div>
            <span id="font-size">ğŸ˜’</span>
            <span id="chartPercentage3">0%</span>
        </div>
        <div class="legend-item">
            <div class="color-box" style="background-color: red;"></div>
            <span id="font-size">ğŸ˜¡</span>
            <span id="chartPercentage4">0%</span>
        </div>
        <div class="legend-item">
            <div class="color-box" style="background-color: purple;"></div>
            <span id="font-size">ğŸ˜”</span>
            <span id="chartPercentage5">0%</span>
        </div>
    </div>
  </div>

  <script>
    // JavaScript ì½”ë“œ
    let count1 = 0;
    let count2 = 0;
    let count3 = 0;
    let count4 = 0;
    let count5 = 0;
    let percentages = [0, 0, 0, 0, 0]; // ì´ˆê¸° í¼ì„¼í‹°ì§€ ê°’ì„ ì €ì¥í•˜ëŠ” ë°°ì—´
    let highestPercentageIndex = null; // ê°€ì¥ ë†’ì€ í¼ì„¼í‹°ì§€ë¥¼ ê°€ì§„ ë²„íŠ¼ ì¸ë±ìŠ¤

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ì €ì¥ëœ ê°’ ë¶ˆëŸ¬ì˜¤ê¸°
    if (localStorage.getItem("count1")) {
        count1 = parseInt(localStorage.getItem("count1"));
        document.getElementById("count1").textContent = count1;
    }
    if (localStorage.getItem("count2")) {
        count2 = parseInt(localStorage.getItem("count2"));
        document.getElementById("count2").textContent = count2;
    }
    if (localStorage.getItem("count3")) {
        count3 = parseInt(localStorage.getItem("count3"));
        document.getElementById("count3").textContent = count3;
    }
    if (localStorage.getItem("count4")) {
        count4 = parseInt(localStorage.getItem("count4"));
        document.getElementById("count4").textContent = count4;
    }
    if (localStorage.getItem("count5")) {
        count5 = parseInt(localStorage.getItem("count5"));
        document.getElementById("count5").textContent = count5;
    }

    // ê° ë²„íŠ¼ì˜ í¼ì„¼í‹°ì§€ í…ìŠ¤íŠ¸ ì´ˆê¸°í™”
    for (let i = 1; i <= 5; i++) {
        const percentage = localStorage.getItem(`chartPercentage${i}`);
        if (percentage !== null) {
            percentages[i - 1] = parseFloat(percentage);
            document.getElementById(`chartPercentage${i}`).textContent = `${percentage}%`;
        }
    }

    const canvas = document.getElementById("chart");
    const ctx = canvas.getContext("2d");

    document.getElementById("button1").addEventListener("click", function () {
        count1++;
        document.getElementById("count1").textContent = count1;
        updatePercentage("count1", "chartPercentage1", percentages, 0);
        drawChart();
        checkHighestPercentage();
        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ê°’ ì €ì¥
        localStorage.setItem("count1", count1);
    });

    document.getElementById("button2").addEventListener("click", function () {
        count2++;
        document.getElementById("count2").textContent = count2;
        updatePercentage("count2", "chartPercentage2", percentages, 1);
        drawChart();
        checkHighestPercentage();
        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ê°’ ì €ì¥
        localStorage.setItem("count2", count2);
    });

    document.getElementById("button3").addEventListener("click", function () {
        count3++;
        document.getElementById("count3").textContent = count3;
        updatePercentage("count3", "chartPercentage3", percentages, 2);
        drawChart();
        checkHighestPercentage();
        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ê°’ ì €ì¥
        localStorage.setItem("count3", count3);
    });

    document.getElementById("button4").addEventListener("click", function () {
        count4++;
        document.getElementById("count4").textContent = count4;
        updatePercentage("count4", "chartPercentage4", percentages, 3);
        drawChart();
        checkHighestPercentage();
        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ê°’ ì €ì¥
        localStorage.setItem("count4", count4);
    });

    document.getElementById("button5").addEventListener("click", function () {
        count5++;
        document.getElementById("count5").textContent = count5;
        updatePercentage("count5", "chartPercentage5", percentages, 4);
        drawChart();
        checkHighestPercentage();
        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ê°’ ì €ì¥
        localStorage.setItem("count5", count5);
    });

    // ì´ˆê¸° ê·¸ë˜í”„ ê·¸ë¦¬ê¸°
    drawChart();
    checkHighestPercentage();

    // ì´ˆê¸°í™” ì˜ˆì•½
    resetCountsAtMidnight();

    // ë§¤ì¼ ìì •ì— ì´ˆê¸°í™”í•˜ëŠ” í•¨ìˆ˜
    function resetCountsAtMidnight() {
        const now = new Date();
        const tomorrow = new Date(now);
        tomorrow.setDate(now.getDate() + 1);
        tomorrow.setHours(0, 0, 0, 0);
        const timeUntilMidnight = tomorrow - now;
        setTimeout(() => {
            // í´ë¦­ íšŸìˆ˜ ì´ˆê¸°í™”
            count1 = 0;
            count2 = 0;
            count3 = 0;
            count4 = 0;
            count5 = 0;
            document.getElementById("count1").textContent = count1;
            document.getElementById("count2").textContent = count2;
            document.getElementById("count3").textContent = count3;
            document.getElementById("count4").textContent = count4;
            document.getElementById("count5").textContent = count5;

            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ì €ì¥ëœ ê°’ ì´ˆê¸°í™”
            localStorage.removeItem("count1");
            localStorage.removeItem("count2");
            localStorage.removeItem("count3");
            localStorage.removeItem("count4");
            localStorage.removeItem("count5");

            // ê·¸ë˜í”„ ì´ˆê¸°í™”
            drawChart();

            // ì™•ê´€ ì´ˆê¸°í™”
            highestPercentageIndex = null;
            updateCrown();

            // ë‹¤ìŒ ë‚  ìì •ê¹Œì§€ ë‹¤ì‹œ ì´ˆê¸°í™” ì˜ˆì•½
            resetCountsAtMidnight();
        }, timeUntilMidnight);
    }

    // í¼ì„¼í‹°ì§€ë¥¼ ë¹„êµí•˜ê³  ê°€ì¥ ë†’ì€ í¼ì„¼í‹°ì§€ë¥¼ ê°€ì§„ ë²„íŠ¼ì— ì™•ê´€ í‘œì‹œ
    function checkHighestPercentage() {
        const highestPercentage = Math.max(...percentages);
        highestPercentageIndex = percentages.indexOf(highestPercentage);
        updateCrown();
    }

    // ì™•ê´€ì„ ì—…ë°ì´íŠ¸í•˜ëŠ” í•¨ìˆ˜
    function updateCrown() {
        for (let i = 1; i <= 5; i++) {
            const crown = document.getElementById(`crown${i}`);
            if (i - 1 === highestPercentageIndex) {
                crown.style.display = "block";
            } else {
                crown.style.display = "none";
            }
        }
    }
    
    function drawChart() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        const counts = [count1, count2, count3, count4, count5];
        const maxCount = Math.max(...counts);
        const barWidth = 80;
        const spacing = 20;

        for (let i = 0; i < counts.length; i++) {
            const x = i * (barWidth + spacing);
            const barHeight = (counts[i] / maxCount) * canvas.height;
            ctx.fillStyle = getColorForButton(i);
            ctx.fillRect(x, canvas.height - barHeight, barWidth, barHeight);
            ctx.fillText(getLabelForButton(i), x + 10, canvas.height + 20);
        }
    }

    function updatePercentage(countId, chartPercentageId, percentages, index) {
        const count = parseInt(document.getElementById(countId).textContent);
        const totalClicks = count1 + count2 + count3 + count4 + count5;
        percentages[index] = (count / totalClicks) * 100;
        const percentageText = percentages[index].toFixed(2);
        document.getElementById(chartPercentageId).textContent = `${percentageText}%`;

        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— í¼ì„¼í‹°ì§€ ê°’ ì €ì¥
        localStorage.setItem(`chartPercentage${index + 1}`, percentageText);
    }

    function getColorForButton(index) {
        const colors = ["orange", "blue", "green", "red", "purple"];
        return colors[index];
    }

    function getLabelForButton(index) {
        const labels = ["ğŸ˜„", "ğŸ˜¢", "ğŸ˜’", "ğŸ˜¡", "ğŸ˜”"];
        return labels[index];
    }
  </script>
</body>
</html>
